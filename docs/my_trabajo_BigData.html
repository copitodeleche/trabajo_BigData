<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Saúl Gil">
<meta name="description" content="A veces hay que abrir estos debates.">
<title>Título de mi website - La tenencia de armas en civiles</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./imagenes/my_favicon_uv.jpeg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
background: #101820;
      }
</style>
<link href="site_libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="site_libs/plotly-binding-4.10.3/plotly.js"></script><script src="site_libs/typedarray-0.1/typedarray.min.js"></script><script src="site_libs/jquery-3.5.1/jquery.min.js"></script><link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link rel="stylesheet" href="my_styles.css">
<link rel="stylesheet" href="./assets/my_css_file.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./my_favicon.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Título de mi website</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item compact">
    <a class="nav-link" href="./index.html" rel="" target=""><i class="bi bi-house-door" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link active" href="./my_trabajo_BigData.html" rel="" target="" aria-current="page">
 <span class="menu-text">Trabajo individual</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:tu-mail@alumni.uv.es" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <div class="quarto-title-block"><div><h1 class="title">La tenencia de armas en civiles</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el código fuente</a></li></ul></div></div>
                  <div>
        <div class="description">
          <p>A veces hay que abrir estos debates.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">trabajo BigData</div>
                <div class="quarto-category">programación</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">armas</div>
                <div class="quarto-category">seguridad</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-heading">Afiliación</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Saúl Gil </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://www.uv.es">
              Universitat de València
              </a>
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">28 de enero de 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Índice</h2>
   
  <ul>
<li><a href="#introducci%C3%B3n" id="toc-introducción" class="nav-link active" data-scroll-target="#introducci%C3%B3n">Introducción</a></li>
  <li><a href="#c%C3%B3digo" id="toc-código" class="nav-link" data-scroll-target="#c%C3%B3digo">Código</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content"><section id="introducción" class="level2"><h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>En la actualidad, la discusión en torno a la tenencia de armas de fuego ha generado un intenso debate en varios países, donde las opiniones divergentes oscilan entre la creencia de que la posesión de armas garantiza la seguridad individual y la preocupación de que pueda incrementar los riesgos asociados con la violencia. Este trabajo se adentrará en la pregunta fundamental: ¿es posible que la tenencia de armas no solo no disminuya la seguridad, sino que también contribuya a fortalecerla?</p>
<p>Antes de introducirnos en los datos dejo este vídeo para definir un poco las dos posturas (a favor y en contra) que existen y sus principales argumentos</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/Tv6GCtKemmI" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
<p>A lo largo de la historia, la relación entre la posesión de armas y la seguridad ha sido analizada desde diferentes perspectivas. Algunos argumentan que la capacidad de los ciudadanos para poseer y portar armas puede actuar como un elemento disuasorio ante la criminalidad, proporcionando una sensación de empoderamiento individual y colectivo. Sin embargo, otros sostienen que una mayor disponibilidad de armas podría derivar en consecuencias adversas, incluyendo un aumento en los incidentes violentos.</p>
<p>Exploraremos este tema desde diversas dimensiones, analizando las estadísticas de seguridad. A través de esta investigación, buscamos entender si la tenencia de armas, bajo ciertas circunstancias y regulaciones, podría no solo no comprometer la seguridad, sino también contribuir a su preservación.</p>
</section><section id="código" class="level2"><h2 class="anchored" data-anchor-id="código">Código</h2>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(eurostat) </span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(fs)</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(<span class="st">"datos"</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Definir la URL y el destino</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>url <span class="ot">&lt;-</span> <span class="st">"https://github.com/copitodeleche/Datos_trabajos/blob/21f73dead967ad21704bead1f332531ffc1b9a04/SAS-BP-Civilian-held-firearms-annexe.xlsx?raw=true"</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>destino <span class="ot">&lt;-</span> <span class="st">"./datos/SAS-BP-Civilian-held-firearms-annexe.xlsx"</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>aa <span class="ot">&lt;-</span> <span class="fu">import</span>(url)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">write.csv</span>(aa, destino)</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a>aa <span class="ot">&lt;-</span> <span class="fu">unite</span>(aa, <span class="st">"Region"</span>, <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="st">"...4"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a>bb <span class="ot">&lt;-</span> aa <span class="sc">%&gt;%</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Estimate civilian firearms/100 persons</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>  <span class="fu">filter</span>(Region <span class="sc">%in%</span> <span class="st">"Europe"</span>)</span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a></span>
<span id="cb1-23"><a href="#cb1-23"></a>url <span class="ot">&lt;-</span> <span class="st">"https://github.com/copitodeleche/Datos_trabajos/blob/c82aa58dbae4f2ad56958a7a4b87f9d20a607d1e/crim_off_cat__custom_9536053_spreadsheet%20(2).xlsx?raw=true"</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>eu2 <span class="ot">&lt;-</span> <span class="fu">import</span>(url)</span>
<span id="cb1-25"><a href="#cb1-25"></a>destino <span class="ot">&lt;-</span> <span class="st">"./datos/crim_off_cat__custom_9536053_spreadsheet%20(2).xlsx"</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="fu">write.csv</span>(eu2, destino)</span>
<span id="cb1-27"><a href="#cb1-27"></a></span>
<span id="cb1-28"><a href="#cb1-28"></a>eu <span class="ot">&lt;-</span> eu2 <span class="sc">%&gt;%</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">where</span>(<span class="sc">~</span><span class="fu">all</span>(<span class="fu">is.na</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"2"</span>), </span>
<span id="cb1-31"><a href="#cb1-31"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>, </span>
<span id="cb1-32"><a href="#cb1-32"></a>               <span class="at">values_to =</span> <span class="st">"robos/100k_habitantes"</span>, </span>
<span id="cb1-33"><a href="#cb1-33"></a>               <span class="at">names_prefix =</span> <span class="st">"X"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-34"><a href="#cb1-34"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="st">"2017"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>  <span class="fu">rename</span>(<span class="st">"Country"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">GEO (Labels)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36"></a>  <span class="fu">select</span>(<span class="st">"robos/100k_habitantes"</span> , <span class="st">"Country"</span>)</span>
<span id="cb1-37"><a href="#cb1-37"></a></span>
<span id="cb1-38"><a href="#cb1-38"></a></span>
<span id="cb1-39"><a href="#cb1-39"></a>bb <span class="ot">&lt;-</span> bb <span class="sc">%&gt;%</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>   <span class="fu">select</span>(<span class="st">"Population 2017"</span>, <span class="st">"Estimate of firearms in civilian possession"</span>, <span class="st">"Country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-41"><a href="#cb1-41"></a>  <span class="fu">mutate</span>(<span class="at">Estimate_of_firearms_per_100k =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Estimate of firearms in civilian possession</span><span class="st">`</span>) <span class="sc">/</span> <span class="st">`</span><span class="at">Population 2017</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">100000</span>)</span>
<span id="cb1-42"><a href="#cb1-42"></a></span>
<span id="cb1-43"><a href="#cb1-43"></a>result_df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(bb, eu, <span class="at">by =</span> <span class="st">"Country"</span>)</span>
<span id="cb1-44"><a href="#cb1-44"></a>result_df <span class="ot">&lt;-</span> result_df <span class="sc">%&gt;%</span></span>
<span id="cb1-45"><a href="#cb1-45"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">ifelse</span>(. <span class="sc">==</span> <span class="st">":"</span>, <span class="cn">NA</span>, .)) <span class="sc">%&gt;%</span></span>
<span id="cb1-46"><a href="#cb1-46"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Primero vamos a ilustrar de una forma más gráfica cuales son los países que más armas por habitantes tiene y después vamos a introducirnos de forma más detallada esstudiando la violencia en los paises con más armas comparados con los que menos armas por habitante tienen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Código</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Mapa</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(giscoR)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(tmap)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a>eu3 <span class="ot">&lt;-</span> eu2 <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6"></a>   <span class="fu">select</span>(<span class="sc">-</span><span class="fu">where</span>(<span class="sc">~</span><span class="fu">all</span>(<span class="fu">is.na</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"2"</span>), </span>
<span id="cb2-8"><a href="#cb2-8"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>, </span>
<span id="cb2-9"><a href="#cb2-9"></a>               <span class="at">values_to =</span> <span class="st">"robos/100k_habitantes"</span>, </span>
<span id="cb2-10"><a href="#cb2-10"></a>               <span class="at">names_prefix =</span> <span class="st">"X"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="st">"2017"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>  <span class="fu">rename</span>(<span class="st">"Country"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">GEO (Labels)</span><span class="st">`</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a>europa <span class="ot">&lt;-</span> <span class="fu">gisco_get_countries</span>(<span class="at">resolution =</span> <span class="st">"01"</span>)</span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a>europa <span class="ot">&lt;-</span> <span class="fu">subset</span>(europa, CNTR_ID <span class="sc">%in%</span> eu3<span class="sc">$</span><span class="st">`</span><span class="at">GEO (Codes)</span><span class="st">`</span>)</span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a></span>
<span id="cb2-20"><a href="#cb2-20"></a>map_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(europa, eu3, <span class="at">by.x =</span> <span class="st">"CNTR_ID"</span>, <span class="at">by.y =</span> <span class="st">"GEO (Codes)"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-21"><a href="#cb2-21"></a>map_data<span class="sc">$</span><span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(map_data<span class="sc">$</span><span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)</span>
<span id="cb2-22"><a href="#cb2-22"></a></span>
<span id="cb2-23"><a href="#cb2-23"></a>mapa <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(map_data) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb2-25"><a href="#cb2-25"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"robos/100k_habitantes"</span>, <span class="at">style =</span> <span class="st">"equal"</span>, <span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">n =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Robos por 100,000 habitantes en Europa (2017)"</span>) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>  <span class="fu">tm_view</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mapa</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>En este gráfico de barras observamos que los paises con más armas por cada 100.000 habitantes son Serbia, Montenegro, Finlandia, Islandia y Austria(Bosnia and Herzegovina sería el cuarto pero no existen datos de violencia así que lo descartamos del estudio).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Código</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Gráfico</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># Convertir la columna 'Estimate_of_firearms_per_100k' a numérica</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>result_df<span class="sc">$</span>Estimate_of_firearms_per_100k <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(result_df<span class="sc">$</span>Estimate_of_firearms_per_100k)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># Ordenar el dataframe por la columna 'Estimate_of_firearms_per_100k' de manera descendente</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>result_df <span class="ot">&lt;-</span> result_df[<span class="fu">order</span>(<span class="sc">-</span>result_df<span class="sc">$</span>Estimate_of_firearms_per_100k), ]</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># Crear la gráfica de barras</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>gráfico1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Country, Estimate_of_firearms_per_100k), <span class="at">y =</span> Estimate_of_firearms_per_100k)) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Países con Más y Menos Armas Civiles por 100,000 habitantes"</span>,</span>
<span id="cb4-13"><a href="#cb4-13"></a>       <span class="at">x =</span> <span class="st">"País"</span>,</span>
<span id="cb4-14"><a href="#cb4-14"></a>       <span class="at">y =</span> <span class="st">"Armas Civiles por 100,000 habitantes"</span>,</span>
<span id="cb4-15"><a href="#cb4-15"></a>       <span class="at">caption =</span> <span class="st">"Fuente: Small Arms Survey"</span>) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>gráfico1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Al analizar la estimación de armas civiles por cada 100,000 habitantes, se observa una tendencia interesante. Países que presentan una mayor posesión de armas per cápita tienden a ser relativamente ricos en comparación con aquellos con menos armas. Un ejemplo de esta relación es la diferencia marcada entre países como Montenegro y Rumania. Montenegro, con una estimación de armas por encima de la media, muestra un perfil económico más sólido, mientras que Rumania, con una posesión de armas más baja, podría indicar una situación económica diferente. Estos patrones sugieren una posible correlación entre la riqueza de un país y la cantidad de armas civiles en posesión de sus habitantes. Aunque no nos vamos a centrar en esa posible correlación, eso es un tema a parte que podría ser interesante para otro momento.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Código</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Gráfico</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>result_df<span class="sc">$</span><span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(result_df<span class="sc">$</span><span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>top_bottom_countries <span class="ot">&lt;-</span> result_df <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, (<span class="fu">n</span>() <span class="sc">-</span> <span class="dv">7</span>)<span class="sc">:</span><span class="fu">n</span>()))</span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>top_bottom_countries<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">factor</span>(top_bottom_countries<span class="sc">$</span>Country, </span>
<span id="cb6-11"><a href="#cb6-11"></a>                                       <span class="at">levels =</span> <span class="fu">rev</span>(top_bottom_countries<span class="sc">$</span>Country))</span>
<span id="cb6-12"><a href="#cb6-12"></a></span>
<span id="cb6-13"><a href="#cb6-13"></a>grafico2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(top_bottom_countries, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Country, <span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>), <span class="at">y =</span> <span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">" Los 8 países con más/menos robos con violencia "</span>,</span>
<span id="cb6-16"><a href="#cb6-16"></a>       <span class="at">x =</span> <span class="st">"Países"</span>,</span>
<span id="cb6-17"><a href="#cb6-17"></a>       <span class="at">y =</span> <span class="st">"Robos/100k habitantes"</span>, </span>
<span id="cb6-18"><a href="#cb6-18"></a>       <span class="at">caption =</span> <span class="st">"Fuente: Eurostat"</span>) <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>grafico2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>A simple vista, al observar la relación entre la posesión de armas de fuego y la tasa de robos por cada 100,000 habitantes, se pueden identificar algunos patrones interesantes en los datos. Los países que exhiben altos niveles de posesión de armas de fuego no parecen mostrar necesariamente una correlación clara con tasas más altas de robos con violencia. Del mismo modo, aquellos países con menor posesión de armas tampoco demuestran de manera evidente tasas más bajas de violencia.</p>
<p>Este hallazgo sugiere que factores adicionales pueden influir significativamente en las tasas de criminalidad, y la relación entre la posesión de armas y la seguridad pública podría ser más compleja de lo que sugieren las percepciones comunes. Será crucial explorar y analizar más a fondo estos datos para identificar posibles correlaciones y entender mejor los determinantes de la seguridad en diferentes contextos.</p>
<p>Para ello vamos a ver la correlación de la forma más clara que se puede hacer que es con un mapa de dispersión.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Código</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Gráfico</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>result <span class="ot">&lt;-</span> result_df <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">rename</span>(<span class="at">robos_100k_habitantes =</span> <span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># Crea el gráfico de dispersión con la línea de regresión</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>scatter <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(result, </span>
<span id="cb8-6"><a href="#cb8-6"></a>                   <span class="at">x =</span> <span class="sc">~</span>Estimate_of_firearms_per_100k, </span>
<span id="cb8-7"><a href="#cb8-7"></a>                   <span class="at">y =</span> <span class="sc">~</span>robos_100k_habitantes, </span>
<span id="cb8-8"><a href="#cb8-8"></a>                   <span class="at">text =</span> <span class="sc">~</span>Country,</span>
<span id="cb8-9"><a href="#cb8-9"></a>                   <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb8-10"><a href="#cb8-10"></a>                   <span class="at">type =</span> <span class="st">"scatter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb8-12"><a href="#cb8-12"></a>    <span class="at">x =</span> <span class="sc">~</span>Estimate_of_firearms_per_100k, </span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="at">y =</span> <span class="sc">~</span><span class="fu">lm</span>(robos_100k_habitantes <span class="sc">~</span> Estimate_of_firearms_per_100k, <span class="at">data =</span> result_df)<span class="sc">$</span>fitted.values,</span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="at">mode =</span> <span class="st">"lines"</span>,</span>
<span id="cb8-15"><a href="#cb8-15"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'red'</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb8-16"><a href="#cb8-16"></a>    <span class="at">name =</span> <span class="st">"Línea de regresión"</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>  <span class="fu">layout</span>(</span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="at">title =</span> <span class="st">"Relación entre robos con violencia y armas por cada 100,000 habitantes"</span>,</span>
<span id="cb8-20"><a href="#cb8-20"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Estimate_of_firearms_per_100k"</span>),</span>
<span id="cb8-21"><a href="#cb8-21"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Robos por 100,000 habitantes"</span>),</span>
<span id="cb8-22"><a href="#cb8-22"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span>,</span>
<span id="cb8-23"><a href="#cb8-23"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb8-24"><a href="#cb8-24"></a>      <span class="at">text =</span> <span class="st">"Fuente: Small Arms Survey y Eurostat"</span>,</span>
<span id="cb8-25"><a href="#cb8-25"></a>      <span class="at">showarrow =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-26"><a href="#cb8-26"></a>      <span class="at">xref =</span> <span class="st">"paper"</span>,</span>
<span id="cb8-27"><a href="#cb8-27"></a>      <span class="at">yref =</span> <span class="st">"paper"</span>,</span>
<span id="cb8-28"><a href="#cb8-28"></a>      <span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb8-29"><a href="#cb8-29"></a>      <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb8-30"><a href="#cb8-30"></a>      <span class="at">xanchor =</span> <span class="st">"left"</span>,</span>
<span id="cb8-31"><a href="#cb8-31"></a>      <span class="at">yanchor =</span> <span class="st">"bottom"</span></span>
<span id="cb8-32"><a href="#cb8-32"></a>    )</span>
<span id="cb8-33"><a href="#cb8-33"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Mostrar el gráfico</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>scatter</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1b32998e39c036829862" style="width:95%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-1b32998e39c036829862">{"x":{"visdat":{"4c501fda2169":["function () ","plotlyVisDat"]},"cur_data":"4c501fda2169","attrs":{"4c501fda2169":{"x":{},"y":{},"text":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"4c501fda2169.1":{"x":{},"y":{},"text":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"color":"red","width":2},"name":"Línea de regresión","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Relación entre robos con violencia y armas por cada 100,000 habitantes","xaxis":{"domain":[0,1],"automargin":true,"title":"Estimate_of_firearms_per_100k"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Robos por 100,000 habitantes"},"hovermode":"closest","annotations":[{"text":"Fuente: Small Arms Survey y Eurostat","showarrow":false,"xref":"paper","yref":"paper","x":0,"y":0,"xanchor":"left","yanchor":"bottom"}],"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[39144.831557731071,39137.380191693286,32358.780003609456,31736.526946107784,29993.016759776536,28947.368421052633,28831.363721628211,28266.03325415677,27584.575348947244,23142.828343916943,21295.664880662447,19621.509003422787,19606.091870832628,18835.616438356166,17625.998347562654,15644.61612747465,14396.802568647781,13681.710213776722,13599.434828682444,12679.133170220202,12023.35967021642,10539.845758354755,10451.573355128729,9926.4705882352937,8374.733853797019,7518.9928369871932,7201.5161086544531,6535.3460972017674,4977.0290964777951,4638.4836183908828,2630.2110406487159,2594.9627194269947,2510.1130588113265],"y":[294.75999999999999,80.819999999999993,2201.9200000000001,1129.5999999999999,1501.4100000000001,394.07999999999998,1791.05,1793.4100000000001,1680.6600000000001,3602.8800000000001,858.82000000000005,1401.3599999999999,2228.96,1708.24,860.54999999999995,994.19000000000005,1765.9300000000001,298.81,598.33000000000004,1969.4200000000001,177.15000000000001,745.28999999999996,819.95000000000005,3721.21,576.57000000000005,349.08999999999997,1398.78,373.38999999999999,580.17999999999995,2686.0100000000002,489.47000000000003,1516.8199999999999,281.57999999999998],"text":["Serbia","Montenegro","Finland","Iceland","Austria","Liechtenstein","Norway","Malta","Switzerland","Sweden","Portugal","Germany","France","Luxembourg","Greece","Slovenia","Italy","Croatia","Lithuania","Belgium","Albania","Latvia","Hungary","Denmark","Bulgaria","Spain","Ireland","Slovakia","Estonia","England and Wales","Romania","Netherlands","Poland"],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[39144.831557731071,39137.380191693286,32358.780003609456,31736.526946107784,29993.016759776536,28947.368421052633,28831.363721628211,28266.03325415677,27584.575348947244,23142.828343916943,21295.664880662447,19621.509003422787,19606.091870832628,18835.616438356166,17625.998347562654,15644.61612747465,14396.802568647781,13681.710213776722,13599.434828682444,12679.133170220202,12023.35967021642,10539.845758354755,10451.573355128729,9926.4705882352937,8374.733853797019,7518.9928369871932,7201.5161086544531,6535.3460972017674,4977.0290964777951,4638.4836183908828,2630.2110406487159,2594.9627194269947,2510.1130588113265],"y":[1363.3980772042778,1363.3557604863406,1324.8597168446058,1321.3259074749519,1311.4244171435405,1305.4861226631867,1304.8273255888971,1301.6167827417116,1297.7467457825962,1272.5218200152121,1262.0316770178622,1252.5240536258559,1252.4364988811367,1248.0609264841044,1241.1914387549302,1229.9390600485492,1222.8526581536876,1218.79160930331,1218.324362861958,1213.0979190793607,1209.3737452713797,1200.9487880959232,1200.447484258455,1197.4653967374561,1188.6529983968032,1183.7931980523244,1181.9902302344826,1178.2070140656372,1169.3572460304931,1167.434627622926,1156.0295370950666,1155.8293599383678,1155.3474940446115],"text":["Serbia","Montenegro","Finland","Iceland","Austria","Liechtenstein","Norway","Malta","Switzerland","Sweden","Portugal","Germany","France","Luxembourg","Greece","Slovenia","Italy","Croatia","Lithuania","Belgium","Albania","Latvia","Hungary","Denmark","Bulgaria","Spain","Ireland","Slovakia","Estonia","England and Wales","Romania","Netherlands","Poland"],"mode":"lines","type":"scatter","line":{"color":"red","width":2},"name":"Línea de regresión","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<p>Tras analizar la relación entre la posesión de armas, representada por la tasa de armas por cada 100,000 habitantes (Estimate_of_firearms_per_100k), y la incidencia de robos violentos por cada 100,000 habitantes (Robos_100k_habitantes), no se observa una clara correlación entre ambos indicadores. El análisis visual mediante un gráfico de dispersión dinámico con una línea de regresión no revela patrones evidentes que sugieran una relación directa entre la cantidad de armas en posesión de civiles y la tasa de robos violentos en los países analizados. Es importante señalar que esta conclusión se basa en la exploración visual y puede requerir análisis estadísticos más avanzados para obtener conclusiones más precisas.</p>
<p>En conclusión, el análisis de los datos disponibles no permite establecer de manera concluyente una correlación entre la posesión de armas y la incidencia de robos violentos. La falta de una relación clara en este estudio sugiere que la dinámica entre la cantidad de armas en posesión de civiles y la tasa de robos violentos puede depender de una multitud de factores adicionales. Es crucial reconocer que la complejidad de este fenómeno podría estar influenciada por variables como la implementación de políticas de control de armas, factores socioeconómicos, y características culturales específicas de cada país. Por lo tanto, se hace necesario realizar investigaciones más detalladas y análisis estadísticos robustos para comprender mejor estas relaciones y sus matices.</p>
<p>Además, es fundamental tener en cuenta que la percepción de si existe o no una relación entre la posesión de armas y la tasa de robos violentos puede depender en gran medida del juicio moral individual. Las opiniones sobre el control de armas y su impacto en la seguridad pública a menudo están influenciadas por valores personales, experiencias culturales y creencias arraigadas. En consecuencia, mientras que los datos y los análisis estadísticos proporcionan información valiosa, la interpretación de estos resultados puede variar significativamente según la perspectiva moral de cada persona. En lo personal mi juicio moral se podría ver reflejado en este video:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/nz1eJvJky8M" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/MxCoIvjDq-g?start=291" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
<p>##Fuentes https://www.smallarmssurvey.org/ https://ec.europa.eu/eurostat</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb10" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">---</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="an">title:</span><span class="co"> La tenencia de armas en civiles</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">  A veces hay que abrir estos debates.</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="an">author:</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">  - name: Saúl Gil</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">    affiliation: Universitat de València</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">    affiliation-url: https://www.uv.es</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="an">date:</span><span class="co"> 2024-01-28   </span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="an">categories:</span><span class="co"> [trabajo BigData, programación, R, armas, seguridad]#--</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="an">title-block-banner:</span><span class="co"> "#101820" #- {true, false, "green","#AA0000"}</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="an">title-block-banner-color:</span><span class="co"> "white"    #-"#FFFFFF" </span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="an">toc-depth:</span><span class="co"> 3</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="an">smooth-scroll:</span><span class="co"> true</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">  html:</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">    backgroundcolor: "#ffffc5"</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">    #embed-resources: true</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co">    link-external-newwindow: true</span></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co">    css: ./assets/my_css_file.css   #- CUIDADO!!!!</span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="an">code-link:</span><span class="co"> true</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">---</span></span>
<span id="cb10-24"><a href="#cb10-24"></a></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="fu">## Introducción</span></span>
<span id="cb10-26"><a href="#cb10-26"></a></span>
<span id="cb10-27"><a href="#cb10-27"></a>En la actualidad, la discusión en torno a la tenencia de armas de fuego ha generado un intenso debate en varios países, donde las opiniones divergentes oscilan entre la creencia de que la posesión de armas garantiza la seguridad individual y la preocupación de que pueda incrementar los riesgos asociados con la violencia. Este trabajo se adentrará en la pregunta fundamental: ¿es posible que la tenencia de armas no solo no disminuya la seguridad, sino que también contribuya a fortalecerla?</span>
<span id="cb10-28"><a href="#cb10-28"></a></span>
<span id="cb10-29"><a href="#cb10-29"></a>Antes de introducirnos en los datos dejo este vídeo para definir un poco las dos posturas (a favor y en contra) que existen y sus principales argumentos </span>
<span id="cb10-30"><a href="#cb10-30"></a></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="in">```{r}</span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">#| echo = FALSE,</span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co">#| out.width = "100%"</span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="fu">library</span>(vembedr)</span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="fu">embed_url</span>(<span class="st">"https://www.youtube.com/watch?v=Tv6GCtKemmI&amp;ab_channel=EconomiayDesarrollo"</span>)</span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="in">```</span></span>
<span id="cb10-39"><a href="#cb10-39"></a></span>
<span id="cb10-40"><a href="#cb10-40"></a></span>
<span id="cb10-41"><a href="#cb10-41"></a>A lo largo de la historia, la relación entre la posesión de armas y la seguridad ha sido analizada desde diferentes perspectivas. Algunos argumentan que la capacidad de los ciudadanos para poseer y portar armas puede actuar como un elemento disuasorio ante la criminalidad, proporcionando una sensación de empoderamiento individual y colectivo. Sin embargo, otros sostienen que una mayor disponibilidad de armas podría derivar en consecuencias adversas, incluyendo un aumento en los incidentes violentos.</span>
<span id="cb10-42"><a href="#cb10-42"></a></span>
<span id="cb10-43"><a href="#cb10-43"></a>Exploraremos este tema desde diversas dimensiones, analizando las estadísticas de seguridad. A través de esta investigación, buscamos entender si la tenencia de armas, bajo ciertas circunstancias y regulaciones, podría no solo no comprometer la seguridad, sino también contribuir a su preservación.</span>
<span id="cb10-44"><a href="#cb10-44"></a></span>
<span id="cb10-45"><a href="#cb10-45"></a></span>
<span id="cb10-46"><a href="#cb10-46"></a><span class="fu">## Código</span></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="in">```{r}</span></span>
<span id="cb10-50"><a href="#cb10-50"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-51"><a href="#cb10-51"></a><span class="co">#| warning: false</span></span>
<span id="cb10-52"><a href="#cb10-52"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-53"><a href="#cb10-53"></a><span class="fu">library</span>(rio)</span>
<span id="cb10-54"><a href="#cb10-54"></a><span class="fu">library</span>(httr)</span>
<span id="cb10-55"><a href="#cb10-55"></a><span class="fu">library</span>(readxl)</span>
<span id="cb10-56"><a href="#cb10-56"></a><span class="fu">library</span>(eurostat) </span>
<span id="cb10-57"><a href="#cb10-57"></a><span class="fu">library</span>(DT)</span>
<span id="cb10-58"><a href="#cb10-58"></a><span class="fu">library</span>(fs)</span>
<span id="cb10-59"><a href="#cb10-59"></a></span>
<span id="cb10-60"><a href="#cb10-60"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(<span class="st">"datos"</span>)</span>
<span id="cb10-61"><a href="#cb10-61"></a><span class="co"># Definir la URL y el destino</span></span>
<span id="cb10-62"><a href="#cb10-62"></a>url <span class="ot">&lt;-</span> <span class="st">"https://github.com/copitodeleche/Datos_trabajos/blob/21f73dead967ad21704bead1f332531ffc1b9a04/SAS-BP-Civilian-held-firearms-annexe.xlsx?raw=true"</span></span>
<span id="cb10-63"><a href="#cb10-63"></a>destino <span class="ot">&lt;-</span> <span class="st">"./datos/SAS-BP-Civilian-held-firearms-annexe.xlsx"</span></span>
<span id="cb10-64"><a href="#cb10-64"></a>aa <span class="ot">&lt;-</span> <span class="fu">import</span>(url)</span>
<span id="cb10-65"><a href="#cb10-65"></a><span class="fu">write.csv</span>(aa, destino)</span>
<span id="cb10-66"><a href="#cb10-66"></a></span>
<span id="cb10-67"><a href="#cb10-67"></a>aa <span class="ot">&lt;-</span> <span class="fu">unite</span>(aa, <span class="st">"Region"</span>, <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="st">"...4"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-68"><a href="#cb10-68"></a></span>
<span id="cb10-69"><a href="#cb10-69"></a>bb <span class="ot">&lt;-</span> aa <span class="sc">%&gt;%</span></span>
<span id="cb10-70"><a href="#cb10-70"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Estimate civilian firearms/100 persons</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-71"><a href="#cb10-71"></a>  <span class="fu">filter</span>(Region <span class="sc">%in%</span> <span class="st">"Europe"</span>)</span>
<span id="cb10-72"><a href="#cb10-72"></a></span>
<span id="cb10-73"><a href="#cb10-73"></a></span>
<span id="cb10-74"><a href="#cb10-74"></a>url <span class="ot">&lt;-</span> <span class="st">"https://github.com/copitodeleche/Datos_trabajos/blob/c82aa58dbae4f2ad56958a7a4b87f9d20a607d1e/crim_off_cat__custom_9536053_spreadsheet%20(2).xlsx?raw=true"</span></span>
<span id="cb10-75"><a href="#cb10-75"></a>eu2 <span class="ot">&lt;-</span> <span class="fu">import</span>(url)</span>
<span id="cb10-76"><a href="#cb10-76"></a>destino <span class="ot">&lt;-</span> <span class="st">"./datos/crim_off_cat__custom_9536053_spreadsheet%20(2).xlsx"</span></span>
<span id="cb10-77"><a href="#cb10-77"></a><span class="fu">write.csv</span>(eu2, destino)</span>
<span id="cb10-78"><a href="#cb10-78"></a></span>
<span id="cb10-79"><a href="#cb10-79"></a>eu <span class="ot">&lt;-</span> eu2 <span class="sc">%&gt;%</span></span>
<span id="cb10-80"><a href="#cb10-80"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">where</span>(<span class="sc">~</span><span class="fu">all</span>(<span class="fu">is.na</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb10-81"><a href="#cb10-81"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"2"</span>), </span>
<span id="cb10-82"><a href="#cb10-82"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>, </span>
<span id="cb10-83"><a href="#cb10-83"></a>               <span class="at">values_to =</span> <span class="st">"robos/100k_habitantes"</span>, </span>
<span id="cb10-84"><a href="#cb10-84"></a>               <span class="at">names_prefix =</span> <span class="st">"X"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-85"><a href="#cb10-85"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="st">"2017"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-86"><a href="#cb10-86"></a>  <span class="fu">rename</span>(<span class="st">"Country"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">GEO (Labels)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-87"><a href="#cb10-87"></a>  <span class="fu">select</span>(<span class="st">"robos/100k_habitantes"</span> , <span class="st">"Country"</span>)</span>
<span id="cb10-88"><a href="#cb10-88"></a></span>
<span id="cb10-89"><a href="#cb10-89"></a></span>
<span id="cb10-90"><a href="#cb10-90"></a>bb <span class="ot">&lt;-</span> bb <span class="sc">%&gt;%</span></span>
<span id="cb10-91"><a href="#cb10-91"></a>   <span class="fu">select</span>(<span class="st">"Population 2017"</span>, <span class="st">"Estimate of firearms in civilian possession"</span>, <span class="st">"Country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-92"><a href="#cb10-92"></a>  <span class="fu">mutate</span>(<span class="at">Estimate_of_firearms_per_100k =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Estimate of firearms in civilian possession</span><span class="st">`</span>) <span class="sc">/</span> <span class="st">`</span><span class="at">Population 2017</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">100000</span>)</span>
<span id="cb10-93"><a href="#cb10-93"></a></span>
<span id="cb10-94"><a href="#cb10-94"></a>result_df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(bb, eu, <span class="at">by =</span> <span class="st">"Country"</span>)</span>
<span id="cb10-95"><a href="#cb10-95"></a>result_df <span class="ot">&lt;-</span> result_df <span class="sc">%&gt;%</span></span>
<span id="cb10-96"><a href="#cb10-96"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">ifelse</span>(. <span class="sc">==</span> <span class="st">":"</span>, <span class="cn">NA</span>, .)) <span class="sc">%&gt;%</span></span>
<span id="cb10-97"><a href="#cb10-97"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb10-98"><a href="#cb10-98"></a></span>
<span id="cb10-99"><a href="#cb10-99"></a><span class="in">```</span></span>
<span id="cb10-100"><a href="#cb10-100"></a></span>
<span id="cb10-101"><a href="#cb10-101"></a>Primero vamos a ilustrar de una forma más gráfica cuales son los países que más armas por habitantes tiene y después vamos a introducirnos de forma más detallada esstudiando la violencia en los paises con más armas comparados con los que menos armas por habitante tienen.</span>
<span id="cb10-102"><a href="#cb10-102"></a></span>
<span id="cb10-103"><a href="#cb10-103"></a>::: panel-tabset</span>
<span id="cb10-104"><a href="#cb10-104"></a><span class="fu">## Código</span></span>
<span id="cb10-107"><a href="#cb10-107"></a><span class="in">```{r}</span></span>
<span id="cb10-108"><a href="#cb10-108"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-109"><a href="#cb10-109"></a><span class="co">#| warning: false</span></span>
<span id="cb10-110"><a href="#cb10-110"></a><span class="fu">library</span>(giscoR)</span>
<span id="cb10-111"><a href="#cb10-111"></a><span class="fu">library</span>(tmap)</span>
<span id="cb10-112"><a href="#cb10-112"></a></span>
<span id="cb10-113"><a href="#cb10-113"></a></span>
<span id="cb10-114"><a href="#cb10-114"></a>eu3 <span class="ot">&lt;-</span> eu2 <span class="sc">%&gt;%</span> </span>
<span id="cb10-115"><a href="#cb10-115"></a>   <span class="fu">select</span>(<span class="sc">-</span><span class="fu">where</span>(<span class="sc">~</span><span class="fu">all</span>(<span class="fu">is.na</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb10-116"><a href="#cb10-116"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"2"</span>), </span>
<span id="cb10-117"><a href="#cb10-117"></a>               <span class="at">names_to =</span> <span class="st">"year"</span>, </span>
<span id="cb10-118"><a href="#cb10-118"></a>               <span class="at">values_to =</span> <span class="st">"robos/100k_habitantes"</span>, </span>
<span id="cb10-119"><a href="#cb10-119"></a>               <span class="at">names_prefix =</span> <span class="st">"X"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-120"><a href="#cb10-120"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="st">"2017"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-121"><a href="#cb10-121"></a>  <span class="fu">rename</span>(<span class="st">"Country"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">GEO (Labels)</span><span class="st">`</span>)</span>
<span id="cb10-122"><a href="#cb10-122"></a></span>
<span id="cb10-123"><a href="#cb10-123"></a></span>
<span id="cb10-124"><a href="#cb10-124"></a>europa <span class="ot">&lt;-</span> <span class="fu">gisco_get_countries</span>(<span class="at">resolution =</span> <span class="st">"01"</span>)</span>
<span id="cb10-125"><a href="#cb10-125"></a></span>
<span id="cb10-126"><a href="#cb10-126"></a>europa <span class="ot">&lt;-</span> <span class="fu">subset</span>(europa, CNTR_ID <span class="sc">%in%</span> eu3<span class="sc">$</span><span class="st">`</span><span class="at">GEO (Codes)</span><span class="st">`</span>)</span>
<span id="cb10-127"><a href="#cb10-127"></a></span>
<span id="cb10-128"><a href="#cb10-128"></a></span>
<span id="cb10-129"><a href="#cb10-129"></a>map_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(europa, eu3, <span class="at">by.x =</span> <span class="st">"CNTR_ID"</span>, <span class="at">by.y =</span> <span class="st">"GEO (Codes)"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-130"><a href="#cb10-130"></a>map_data<span class="sc">$</span><span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(map_data<span class="sc">$</span><span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)</span>
<span id="cb10-131"><a href="#cb10-131"></a></span>
<span id="cb10-132"><a href="#cb10-132"></a>mapa <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(map_data) <span class="sc">+</span></span>
<span id="cb10-133"><a href="#cb10-133"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb10-134"><a href="#cb10-134"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"robos/100k_habitantes"</span>, <span class="at">style =</span> <span class="st">"equal"</span>, <span class="at">palette =</span> <span class="st">"Blues"</span>, <span class="at">n =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-135"><a href="#cb10-135"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Robos por 100,000 habitantes en Europa (2017)"</span>) <span class="sc">+</span></span>
<span id="cb10-136"><a href="#cb10-136"></a>  <span class="fu">tm_view</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"bottom"</span>))</span>
<span id="cb10-137"><a href="#cb10-137"></a></span>
<span id="cb10-138"><a href="#cb10-138"></a><span class="in">```</span></span>
<span id="cb10-139"><a href="#cb10-139"></a><span class="fu">## Mapa</span></span>
<span id="cb10-142"><a href="#cb10-142"></a><span class="in">```{r}</span></span>
<span id="cb10-143"><a href="#cb10-143"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-144"><a href="#cb10-144"></a>mapa</span>
<span id="cb10-145"><a href="#cb10-145"></a><span class="in">```</span></span>
<span id="cb10-146"><a href="#cb10-146"></a>:::</span>
<span id="cb10-147"><a href="#cb10-147"></a>En este gráfico de barras observamos que los paises con más armas por cada 100.000 habitantes son Serbia, Montenegro, Finlandia, Islandia y Austria(Bosnia and Herzegovina sería el cuarto pero no existen datos de violencia así que lo descartamos del estudio).</span>
<span id="cb10-148"><a href="#cb10-148"></a></span>
<span id="cb10-149"><a href="#cb10-149"></a>::: panel-tabset</span>
<span id="cb10-150"><a href="#cb10-150"></a><span class="fu">## Código</span></span>
<span id="cb10-153"><a href="#cb10-153"></a><span class="in">```{r}</span></span>
<span id="cb10-154"><a href="#cb10-154"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-155"><a href="#cb10-155"></a><span class="co">#| warning: false</span></span>
<span id="cb10-156"><a href="#cb10-156"></a></span>
<span id="cb10-157"><a href="#cb10-157"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-158"><a href="#cb10-158"></a></span>
<span id="cb10-159"><a href="#cb10-159"></a><span class="co"># Convertir la columna 'Estimate_of_firearms_per_100k' a numérica</span></span>
<span id="cb10-160"><a href="#cb10-160"></a>result_df<span class="sc">$</span>Estimate_of_firearms_per_100k <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(result_df<span class="sc">$</span>Estimate_of_firearms_per_100k)</span>
<span id="cb10-161"><a href="#cb10-161"></a></span>
<span id="cb10-162"><a href="#cb10-162"></a><span class="co"># Ordenar el dataframe por la columna 'Estimate_of_firearms_per_100k' de manera descendente</span></span>
<span id="cb10-163"><a href="#cb10-163"></a>result_df <span class="ot">&lt;-</span> result_df[<span class="fu">order</span>(<span class="sc">-</span>result_df<span class="sc">$</span>Estimate_of_firearms_per_100k), ]</span>
<span id="cb10-164"><a href="#cb10-164"></a></span>
<span id="cb10-165"><a href="#cb10-165"></a><span class="co"># Crear la gráfica de barras</span></span>
<span id="cb10-166"><a href="#cb10-166"></a>gráfico1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Country, Estimate_of_firearms_per_100k), <span class="at">y =</span> Estimate_of_firearms_per_100k)) <span class="sc">+</span></span>
<span id="cb10-167"><a href="#cb10-167"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb10-168"><a href="#cb10-168"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Países con Más y Menos Armas Civiles por 100,000 habitantes"</span>,</span>
<span id="cb10-169"><a href="#cb10-169"></a>       <span class="at">x =</span> <span class="st">"País"</span>,</span>
<span id="cb10-170"><a href="#cb10-170"></a>       <span class="at">y =</span> <span class="st">"Armas Civiles por 100,000 habitantes"</span>,</span>
<span id="cb10-171"><a href="#cb10-171"></a>       <span class="at">caption =</span> <span class="st">"Fuente: Small Arms Survey"</span>) <span class="sc">+</span></span>
<span id="cb10-172"><a href="#cb10-172"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb10-173"><a href="#cb10-173"></a></span>
<span id="cb10-174"><a href="#cb10-174"></a></span>
<span id="cb10-175"><a href="#cb10-175"></a><span class="in">```</span></span>
<span id="cb10-176"><a href="#cb10-176"></a><span class="fu">## Gráfico</span></span>
<span id="cb10-179"><a href="#cb10-179"></a><span class="in">```{r}</span></span>
<span id="cb10-180"><a href="#cb10-180"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-181"><a href="#cb10-181"></a>gráfico1</span>
<span id="cb10-182"><a href="#cb10-182"></a><span class="in">```</span></span>
<span id="cb10-183"><a href="#cb10-183"></a></span>
<span id="cb10-184"><a href="#cb10-184"></a>:::</span>
<span id="cb10-185"><a href="#cb10-185"></a></span>
<span id="cb10-186"><a href="#cb10-186"></a>Al analizar la estimación de armas civiles por cada 100,000 habitantes, se observa una tendencia interesante. Países que presentan una mayor posesión de armas per cápita tienden a ser relativamente ricos en comparación con aquellos con menos armas. Un ejemplo de esta relación es la diferencia marcada entre países como Montenegro y Rumania. Montenegro, con una estimación de armas por encima de la media, muestra un perfil económico más sólido, mientras que Rumania, con una posesión de armas más baja, podría indicar una situación económica diferente. Estos patrones sugieren una posible correlación entre la riqueza de un país y la cantidad de armas civiles en posesión de sus habitantes. Aunque no nos vamos a centrar en esa posible correlación, eso es un tema a parte que podría ser interesante para otro momento.</span>
<span id="cb10-187"><a href="#cb10-187"></a></span>
<span id="cb10-188"><a href="#cb10-188"></a>::: panel-tabset</span>
<span id="cb10-189"><a href="#cb10-189"></a><span class="fu">## Código</span></span>
<span id="cb10-192"><a href="#cb10-192"></a><span class="in">```{r}</span></span>
<span id="cb10-193"><a href="#cb10-193"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-194"><a href="#cb10-194"></a><span class="co">#| warning: false</span></span>
<span id="cb10-195"><a href="#cb10-195"></a><span class="fu">library</span>(plotly)</span>
<span id="cb10-196"><a href="#cb10-196"></a></span>
<span id="cb10-197"><a href="#cb10-197"></a>result_df<span class="sc">$</span><span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(result_df<span class="sc">$</span><span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)</span>
<span id="cb10-198"><a href="#cb10-198"></a></span>
<span id="cb10-199"><a href="#cb10-199"></a>top_bottom_countries <span class="ot">&lt;-</span> result_df <span class="sc">%&gt;%</span></span>
<span id="cb10-200"><a href="#cb10-200"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-201"><a href="#cb10-201"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, (<span class="fu">n</span>() <span class="sc">-</span> <span class="dv">7</span>)<span class="sc">:</span><span class="fu">n</span>()))</span>
<span id="cb10-202"><a href="#cb10-202"></a></span>
<span id="cb10-203"><a href="#cb10-203"></a></span>
<span id="cb10-204"><a href="#cb10-204"></a>top_bottom_countries<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">factor</span>(top_bottom_countries<span class="sc">$</span>Country, </span>
<span id="cb10-205"><a href="#cb10-205"></a>                                       <span class="at">levels =</span> <span class="fu">rev</span>(top_bottom_countries<span class="sc">$</span>Country))</span>
<span id="cb10-206"><a href="#cb10-206"></a></span>
<span id="cb10-207"><a href="#cb10-207"></a>grafico2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(top_bottom_countries, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Country, <span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>), <span class="at">y =</span> <span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb10-208"><a href="#cb10-208"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb10-209"><a href="#cb10-209"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">" Los 8 países con más/menos robos con violencia "</span>,</span>
<span id="cb10-210"><a href="#cb10-210"></a>       <span class="at">x =</span> <span class="st">"Países"</span>,</span>
<span id="cb10-211"><a href="#cb10-211"></a>       <span class="at">y =</span> <span class="st">"Robos/100k habitantes"</span>, </span>
<span id="cb10-212"><a href="#cb10-212"></a>       <span class="at">caption =</span> <span class="st">"Fuente: Eurostat"</span>) <span class="sc">+</span></span>
<span id="cb10-213"><a href="#cb10-213"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-214"><a href="#cb10-214"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb10-215"><a href="#cb10-215"></a></span>
<span id="cb10-216"><a href="#cb10-216"></a></span>
<span id="cb10-217"><a href="#cb10-217"></a><span class="in">```</span></span>
<span id="cb10-218"><a href="#cb10-218"></a></span>
<span id="cb10-219"><a href="#cb10-219"></a><span class="fu">## Gráfico</span></span>
<span id="cb10-222"><a href="#cb10-222"></a><span class="in">```{r}</span></span>
<span id="cb10-223"><a href="#cb10-223"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-224"><a href="#cb10-224"></a>grafico2</span>
<span id="cb10-225"><a href="#cb10-225"></a><span class="in">```</span></span>
<span id="cb10-226"><a href="#cb10-226"></a>:::</span>
<span id="cb10-227"><a href="#cb10-227"></a></span>
<span id="cb10-228"><a href="#cb10-228"></a></span>
<span id="cb10-229"><a href="#cb10-229"></a>A simple vista, al observar la relación entre la posesión de armas de fuego y la tasa de robos por cada 100,000 habitantes, se pueden identificar algunos patrones interesantes en los datos. Los países que exhiben altos niveles de posesión de armas de fuego no parecen mostrar necesariamente una correlación clara con tasas más altas de robos con violencia. Del mismo modo, aquellos países con menor posesión de armas tampoco demuestran de manera evidente tasas más bajas de violencia.</span>
<span id="cb10-230"><a href="#cb10-230"></a></span>
<span id="cb10-231"><a href="#cb10-231"></a>Este hallazgo sugiere que factores adicionales pueden influir significativamente en las tasas de criminalidad, y la relación entre la posesión de armas y la seguridad pública podría ser más compleja de lo que sugieren las percepciones comunes. Será crucial explorar y analizar más a fondo estos datos para identificar posibles correlaciones y entender mejor los determinantes de la seguridad en diferentes contextos.</span>
<span id="cb10-232"><a href="#cb10-232"></a></span>
<span id="cb10-233"><a href="#cb10-233"></a>Para ello vamos a ver la correlación de la forma más clara que se puede hacer que es con un mapa de dispersión.</span>
<span id="cb10-234"><a href="#cb10-234"></a></span>
<span id="cb10-235"><a href="#cb10-235"></a>::: panel-tabset</span>
<span id="cb10-236"><a href="#cb10-236"></a><span class="fu">## Código</span></span>
<span id="cb10-239"><a href="#cb10-239"></a><span class="in">```{r}</span></span>
<span id="cb10-240"><a href="#cb10-240"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-241"><a href="#cb10-241"></a><span class="co">#| warning: false</span></span>
<span id="cb10-242"><a href="#cb10-242"></a>result <span class="ot">&lt;-</span> result_df <span class="sc">%&gt;%</span></span>
<span id="cb10-243"><a href="#cb10-243"></a>  <span class="fu">rename</span>(<span class="at">robos_100k_habitantes =</span> <span class="st">`</span><span class="at">robos/100k_habitantes</span><span class="st">`</span>)</span>
<span id="cb10-244"><a href="#cb10-244"></a></span>
<span id="cb10-245"><a href="#cb10-245"></a><span class="co"># Crea el gráfico de dispersión con la línea de regresión</span></span>
<span id="cb10-246"><a href="#cb10-246"></a>scatter <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(result, </span>
<span id="cb10-247"><a href="#cb10-247"></a>                   <span class="at">x =</span> <span class="sc">~</span>Estimate_of_firearms_per_100k, </span>
<span id="cb10-248"><a href="#cb10-248"></a>                   <span class="at">y =</span> <span class="sc">~</span>robos_100k_habitantes, </span>
<span id="cb10-249"><a href="#cb10-249"></a>                   <span class="at">text =</span> <span class="sc">~</span>Country,</span>
<span id="cb10-250"><a href="#cb10-250"></a>                   <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb10-251"><a href="#cb10-251"></a>                   <span class="at">type =</span> <span class="st">"scatter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-252"><a href="#cb10-252"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb10-253"><a href="#cb10-253"></a>    <span class="at">x =</span> <span class="sc">~</span>Estimate_of_firearms_per_100k, </span>
<span id="cb10-254"><a href="#cb10-254"></a>    <span class="at">y =</span> <span class="sc">~</span><span class="fu">lm</span>(robos_100k_habitantes <span class="sc">~</span> Estimate_of_firearms_per_100k, <span class="at">data =</span> result_df)<span class="sc">$</span>fitted.values,</span>
<span id="cb10-255"><a href="#cb10-255"></a>    <span class="at">mode =</span> <span class="st">"lines"</span>,</span>
<span id="cb10-256"><a href="#cb10-256"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'red'</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb10-257"><a href="#cb10-257"></a>    <span class="at">name =</span> <span class="st">"Línea de regresión"</span></span>
<span id="cb10-258"><a href="#cb10-258"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-259"><a href="#cb10-259"></a>  <span class="fu">layout</span>(</span>
<span id="cb10-260"><a href="#cb10-260"></a>    <span class="at">title =</span> <span class="st">"Relación entre robos con violencia y armas por cada 100,000 habitantes"</span>,</span>
<span id="cb10-261"><a href="#cb10-261"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Estimate_of_firearms_per_100k"</span>),</span>
<span id="cb10-262"><a href="#cb10-262"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Robos por 100,000 habitantes"</span>),</span>
<span id="cb10-263"><a href="#cb10-263"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span>,</span>
<span id="cb10-264"><a href="#cb10-264"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb10-265"><a href="#cb10-265"></a>      <span class="at">text =</span> <span class="st">"Fuente: Small Arms Survey y Eurostat"</span>,</span>
<span id="cb10-266"><a href="#cb10-266"></a>      <span class="at">showarrow =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-267"><a href="#cb10-267"></a>      <span class="at">xref =</span> <span class="st">"paper"</span>,</span>
<span id="cb10-268"><a href="#cb10-268"></a>      <span class="at">yref =</span> <span class="st">"paper"</span>,</span>
<span id="cb10-269"><a href="#cb10-269"></a>      <span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb10-270"><a href="#cb10-270"></a>      <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb10-271"><a href="#cb10-271"></a>      <span class="at">xanchor =</span> <span class="st">"left"</span>,</span>
<span id="cb10-272"><a href="#cb10-272"></a>      <span class="at">yanchor =</span> <span class="st">"bottom"</span></span>
<span id="cb10-273"><a href="#cb10-273"></a>    )</span>
<span id="cb10-274"><a href="#cb10-274"></a>  )</span>
<span id="cb10-275"><a href="#cb10-275"></a></span>
<span id="cb10-276"><a href="#cb10-276"></a><span class="in">```</span></span>
<span id="cb10-277"><a href="#cb10-277"></a></span>
<span id="cb10-278"><a href="#cb10-278"></a><span class="fu">## Gráfico</span></span>
<span id="cb10-281"><a href="#cb10-281"></a><span class="in">```{r}</span></span>
<span id="cb10-282"><a href="#cb10-282"></a><span class="co">#| code-fold: true</span></span>
<span id="cb10-283"><a href="#cb10-283"></a><span class="co"># Mostrar el gráfico</span></span>
<span id="cb10-284"><a href="#cb10-284"></a>scatter</span>
<span id="cb10-285"><a href="#cb10-285"></a><span class="in">```</span></span>
<span id="cb10-286"><a href="#cb10-286"></a></span>
<span id="cb10-287"><a href="#cb10-287"></a>:::</span>
<span id="cb10-288"><a href="#cb10-288"></a></span>
<span id="cb10-289"><a href="#cb10-289"></a>Tras analizar la relación entre la posesión de armas, representada por la tasa de armas por cada 100,000 habitantes (Estimate_of_firearms_per_100k), y la incidencia de robos violentos por cada 100,000 habitantes (Robos_100k_habitantes), no se observa una clara correlación entre ambos indicadores. El análisis visual mediante un gráfico de dispersión dinámico con una línea de regresión no revela patrones evidentes que sugieran una relación directa entre la cantidad de armas en posesión de civiles y la tasa de robos violentos en los países analizados. Es importante señalar que esta conclusión se basa en la exploración visual y puede requerir análisis estadísticos más avanzados para obtener conclusiones más precisas. </span>
<span id="cb10-290"><a href="#cb10-290"></a></span>
<span id="cb10-291"><a href="#cb10-291"></a>En conclusión, el análisis de los datos disponibles no permite establecer de manera concluyente una correlación entre la posesión de armas y la incidencia de robos violentos. La falta de una relación clara en este estudio sugiere que la dinámica entre la cantidad de armas en posesión de civiles y la tasa de robos violentos puede depender de una multitud de factores adicionales. Es crucial reconocer que la complejidad de este fenómeno podría estar influenciada por variables como la implementación de políticas de control de armas, factores socioeconómicos, y características culturales específicas de cada país. Por lo tanto, se hace necesario realizar investigaciones más detalladas y análisis estadísticos robustos para comprender mejor estas relaciones y sus matices.</span>
<span id="cb10-292"><a href="#cb10-292"></a></span>
<span id="cb10-293"><a href="#cb10-293"></a>Además, es fundamental tener en cuenta que la percepción de si existe o no una relación entre la posesión de armas y la tasa de robos violentos puede depender en gran medida del juicio moral individual. Las opiniones sobre el control de armas y su impacto en la seguridad pública a menudo están influenciadas por valores personales, experiencias culturales y creencias arraigadas. En consecuencia, mientras que los datos y los análisis estadísticos proporcionan información valiosa, la interpretación de estos resultados puede variar significativamente según la perspectiva moral de cada persona. En lo personal mi juicio moral se podría ver reflejado en este video: </span>
<span id="cb10-294"><a href="#cb10-294"></a></span>
<span id="cb10-297"><a href="#cb10-297"></a><span class="in">```{r}</span></span>
<span id="cb10-298"><a href="#cb10-298"></a><span class="co">#| echo = FALSE,</span></span>
<span id="cb10-299"><a href="#cb10-299"></a><span class="co">#| out.width = "100%"</span></span>
<span id="cb10-300"><a href="#cb10-300"></a><span class="fu">library</span>(vembedr)</span>
<span id="cb10-301"><a href="#cb10-301"></a><span class="fu">embed_url</span>(<span class="st">"https://www.youtube.com/watch?v=nz1eJvJky8M&amp;ab_channel=TodoNoticias"</span>)</span>
<span id="cb10-302"><a href="#cb10-302"></a><span class="in">```</span></span>
<span id="cb10-305"><a href="#cb10-305"></a><span class="in">```{r}</span></span>
<span id="cb10-306"><a href="#cb10-306"></a><span class="co">#| echo = FALSE,</span></span>
<span id="cb10-307"><a href="#cb10-307"></a><span class="co">#| out.width = "100%"</span></span>
<span id="cb10-308"><a href="#cb10-308"></a><span class="fu">library</span>(vembedr)</span>
<span id="cb10-309"><a href="#cb10-309"></a><span class="fu">embed_url</span>(<span class="st">"https://www.youtube.com/watch?v=MxCoIvjDq-g&amp;t=291s&amp;ab_channel=LibertadYLoQueSurja"</span>)</span>
<span id="cb10-310"><a href="#cb10-310"></a><span class="in">```</span></span>
<span id="cb10-311"><a href="#cb10-311"></a></span>
<span id="cb10-312"><a href="#cb10-312"></a></span>
<span id="cb10-313"><a href="#cb10-313"></a>##Fuentes</span>
<span id="cb10-314"><a href="#cb10-314"></a>https://www.smallarmssurvey.org/</span>
<span id="cb10-315"><a href="#cb10-315"></a>https://ec.europa.eu/eurostat</span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">© 2022 Pedro Navaja</div>   
    <div class="nav-footer-center">Hecho con <a href="https://quarto.org">Quarto</a></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/<tu-usuario-github>">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:<tu-mail>@alumni.uv.es">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>